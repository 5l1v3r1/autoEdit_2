<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: deploy.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: deploy.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
* Simple script to automate the deployment of the app.
*/
var fs = require("fs");
var spawn = require('child_process').spawn;
// https://www.npmjs.com/package/nwjs-builder
var NwBuilder = require('nw-builder');

var buildDir = './build';
var packageJsonFile = "./package.json";
// read package.json file 
var packageJson = require(packageJsonFile);

/**
* checks if build dir exists and if it doesn't creates it.
*/
console.log("checking if build folder is present")

if (!fs.existsSync(buildDir)){
	console.log("build folder not present, creating build folder")
    fs.mkdirSync(buildDir);
}else{
	// do nothing, build folder was already there
	console.log("build folder was already present")
}

/**
* Hiding toolbar for deployment
*/
packageJson.window.toolbar = false;
// write file back to system.
fs.writeFileSync(packageJsonFile, JSON.stringify(packageJson, null,  4))

/**
* Setup deploy code preferences
*/
//
//// Deploying/building app
var nw = new NwBuilder({
  // files: ['./**'], // simple-glob format, would select everything in current folder.
  //chosing files to include, excludes everything else.
  files: ['./frontEnd/**','./interactive_transcription_generator/**','./node_modules/**','./config.js','./package.json' ], 
  // platforms: ['osx32', 'osx64', 'win32', 'win64', 'linux32', 'linux64']
  //for now only osx64 as need to recompile ffmpeg for other versions. 
  platforms: ['osx64','win64'],
  //https://github.com/nwjs/nw-builder#optionsmacicns
  macIcns: "./nw.icns",
  // MAC ONLY: Pass a string containing the path to your own plist file. If a string isn't passed, a plist file will be generated from your package.json. Pass an object to overwrite or add properties to the generated plist file.
  // https://github.com/nwjs/nw-builder#optionsmacplist
  // macPlist: "",
  // nwjs version 
  //MAC ONLY: Use a app.nw folder instead of ZIP file, this significantly improves the startup speed of applications on mac, since no decompressing is needed. Builds on other platforms will still use ZIP files. The default behaviour of node-webkit-builder is to not use ZIP files on the mac platform. In case of the mac platform the option macZip can override the option zip.
  // zip: true,
  version: '0.12.3'
});

/**
* Building/deploying the app in build folder.
*/
console.log("About to package the app")

nw.build().then(function () {
  console.log('Finished packaging the app');
	// on deploy finish, change to show toolbar,for development
	packageJson.window.toolbar = true;
	// write file back down to disk 
	fs.writeFileSync(packageJsonFile, JSON.stringify(packageJson, null,  4))


	/**
	* packaging app in dmg for os x, and placing it on the Desktop.
	* `npm install appdmg  -g` might require to be installed globally for it to work
	* appdmg appdmg.json ~/Desktop/autoEdit2.dmg
	* seems like this could be the issue https://github.com/LinusU/node-appdmg/issues/63
	*/
	///////////////////////////////////////////////////////
	//// or spawn process
	//// appdmg appdmg.json ~/Desktop/autoEdit2.dmg
	// var spawn = require('child_process').spawn;
	// var appdmg = spawn('appdmg', ['./appdmg.json', '~/Desktop/autoEdit2.dmg']);

	// appdmg.stdout.on('data', function(data) {
	//   console.log("stdout: " +data);
	// });

	// appdmg.stderr.on('data', function(data) {
	//   console.log("stderr:" +data);
	// });

	// appdmg.on('close', function(code)  {
	//   console.log("child process exited with code" +code);
	// });
	///////////////////////////////////////////////////////
	// var appdmg = require('appdmg');
	// var ee = appdmg({ source: './appdmg.json', target: '~/Desktop/autoEdit2.dmg' });

	// ee.on('progress', function (info) {
	//    console.log("progress")
	//   // console.log(info.current, into.total, info.type)
	//   // info.current is the current step 
	//   // info.total is the total number of steps 
	//   // info.type is on of 'step-begin', 'step-end' 
	 
	//   // 'step-begin' 
	//   // info.title is the title of the current step 
	 
	//   // 'step-end' 
	//   // info.status is one of 'ok', 'skip', 'fail' 
	// });
	 
	// ee.on('finish', function () {
	//   // There now is a `test.dmg` file 
	//   console.log("check desktop for .dmg file")
	// });
	 
	// ee.on('error', function (err) {
	//   // An error occurred 
	//   console.log("error")
	//   console.log(err)
	// });

	
}).catch(function (error) {
  console.error(error);
	//on deploy finish, change to show toolbar,for development use
	packageJson.window.toolbar = true;
	//write file back down to disk 
	fs.writeFileSync(packageJsonFile, JSON.stringify(packageJson, null,  4))
	
});


</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="EDL.html">EDL</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addsinfoontrimmedclipstolistoffiles.">adds info on trimmed clips to list of files.</a></li><li><a href="global.html#autoEdit2API">autoEdit2API</a></li><li><a href="global.html#convertTakesinaconfigobjectwithpropreties:src,outputName,ffmpegBinandoptionalcallback.">convert
Takes in a config object with propreties: src, outputName, ffmpegBin and optional callback.</a></li><li><a href="global.html#convertToWav">convertToWav</a></li><li><a href="global.html#createSrtContent">createSrtContent</a></li><li><a href="global.html#fromSeconds">fromSeconds</a></li><li><a href="global.html#fromSecondsForSrt">fromSecondsForSrt</a></li><li><a href="global.html#fs">fs</a></li><li><a href="global.html#getFileName">getFileName</a></li><li><a href="global.html#makePaperEdit">makePaperEdit</a></li><li><a href="global.html#nw">nw</a></li><li><a href="global.html#padNumber">padNumber</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#send_to_gentle">send_to_gentle</a></li><li><a href="global.html#SendToWatson">SendToWatson</a></li><li><a href="global.html#splitsanaudiofile,ifitexceeds5minutes,in5minutesintervalls.usingffprobetoreadduration.ffmpegpassedtotrimmermodule.savestrimmedclipsintempfolder">splits an audio file, if it exceeds 5 minutes, in 5 minutes intervalls.  
using ffprobe to read duration. ffmpeg passed to trimmer module.
saves trimmed clips in temp folder</a></li><li><a href="global.html#toSeconds">toSeconds</a></li><li><a href="global.html#transcribeTakesinthefilepathtoamediaaudioorvideofileandreturnsajsonoftranscription.convertsaudioormediafileintoaudiomeetingIBMSpecsdividesaudiotosendtoSTTAPIinto5minchunkssendsallclipsallatoncereconnectsresultsasreturnedbySTTAPIintoonejsonfilethatmeetstheautoEdit2specsreturnsthatascallback">transcribe
Takes in the file path to a media audio or video file and returns a json of transcription.
converts audio or media file into audio meeting IBM Specs
divides audio to send to STT API into 5 min chunks
sends all clips all at once 
reconnects results as returned by STT API into one json file that meets the autoEdit2 specs
returns that as callback</a></li><li><a href="global.html#trim">trim</a></li><li><a href="global.html#watson">watson</a></li><li><a href="global.html#%257Bstirng%257DEDL-andEDLstringforanEDLline.">{stirng} EDL - and EDL string  for an EDL line.</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.2</a> on Tue Oct 18 2016 10:41:31 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
